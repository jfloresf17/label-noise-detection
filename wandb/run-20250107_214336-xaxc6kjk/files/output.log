Traceback (most recent call last):
  File "/home/tidop/projects/Noisy-Student/train_teacher.py", line 274, in <module>
    typer.run(train_teacher)
  File "/home/tidop/Documentos/miniconda3/envs/deep/lib/python3.10/site-packages/typer/main.py", line 1080, in run
    app()
  File "/home/tidop/Documentos/miniconda3/envs/deep/lib/python3.10/site-packages/typer/main.py", line 338, in __call__
    raise e
  File "/home/tidop/Documentos/miniconda3/envs/deep/lib/python3.10/site-packages/typer/main.py", line 321, in __call__
    return get_command(self)(*args, **kwargs)
  File "/home/tidop/Documentos/miniconda3/envs/deep/lib/python3.10/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
  File "/home/tidop/Documentos/miniconda3/envs/deep/lib/python3.10/site-packages/typer/core.py", line 665, in main
    return _main(
  File "/home/tidop/Documentos/miniconda3/envs/deep/lib/python3.10/site-packages/typer/core.py", line 197, in _main
    rv = self.invoke(ctx)
  File "/home/tidop/Documentos/miniconda3/envs/deep/lib/python3.10/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/tidop/Documentos/miniconda3/envs/deep/lib/python3.10/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
  File "/home/tidop/Documentos/miniconda3/envs/deep/lib/python3.10/site-packages/typer/main.py", line 703, in wrapper
    return callback(**use_params)
  File "/home/tidop/projects/Noisy-Student/train_teacher.py", line 129, in train_teacher
    loss = symmetric_cross_entropy(masks, outputs, alpha, beta)
  File "/home/tidop/projects/Noisy-Student/loss_function.py", line 201, in symmetric_cross_entropy
    ce_forward = (- y_true * torch.log(y_pred_clamped)).sum() / y_true.size(1)
IndexError: Dimension out of range (expected to be in range of [-1, 0], but got 1)
╭───────────────────── Traceback (most recent call last) ──────────────────────╮
│ /home/tidop/projects/Noisy-Student/train_teacher.py:129 in train_teacher     │
│                                                                              │
│   126 │   │   │   outputs = torch.sigmoid(logits)                            │
│   127 │   │   │                                                              │
│   128 │   │   │   # Calculate losses (Symmetric Cross Entropy)               │
│ ❱ 129 │   │   │   loss = symmetric_cross_entropy(masks, outputs, alpha, beta │
│   130 │   │   │                                                              │
│   131 │   │   │   # Backward pass and optimization                           │
│   132 │   │   │   loss.backward()                                            │
│                                                                              │
│ ╭───────────────────────────────── locals ─────────────────────────────────╮ │
│ │                  alpha = 0.01                                            │ │
│ │             batch_size = 16                                              │ │
│ │                   beta = 1                                               │ │
│ │ combined_train_dataset = <torch.utils.data.dataset.ConcatDataset object  │ │
│ │                          at 0x71c6500bbc40>                              │ │
│ │   combined_val_dataset = <torch.utils.data.dataset.ConcatDataset object  │ │
│ │                          at 0x71c6500bbaf0>                              │ │
│ │                 config = {                                               │ │
│ │                          │   'device': 'cuda',                           │ │
│ │                          │   'learning_rate': '1e-4',                    │ │
│ │                          │   'data': {                                   │ │
│ │                          │   │   'batch_size': 16,                       │ │
│ │                          │   │   'num_workers': 16,                      │ │
│ │                          │   │   'whu_path':                             │ │
│ │                          '/media/tidop/Datos_4TB1/databases/whu_adjuste… │ │
│ │                          │   │   'alabama_path':                         │ │
│ │                          '/media/tidop/Datos_4TB1/databases/alabama',    │ │
│ │                          │   │   'datacentric_image_path':               │ │
│ │                          '/media/tidop/Datos_4TB1/databases/kaggle/data… │ │
│ │                          │   │   'label_noisy_path':                     │ │
│ │                          '/media/tidop/Datos_4TB1/databases/kaggle/data… │ │
│ │                          │   },                                          │ │
│ │                          │   'Normalize': {                              │ │
│ │                          │   │   'apply': True,                          │ │
│ │                          │   │   'WHU': {                                │ │
│ │                          │   │   │   'mean': [                           │ │
│ │                          │   │   │   │   72.62323902,                    │ │
│ │                          │   │   │   │   99.33869521,                    │ │
│ │                          │   │   │   │   82.94464024                     │ │
│ │                          │   │   │   ],                                  │ │
│ │                          │   │   │   'std': [                            │ │
│ │                          │   │   │   │   43.81751311,                    │ │
│ │                          │   │   │   │   42.46326449,                    │ │
│ │                          │   │   │   │   50.62061044                     │ │
│ │                          │   │   │   ]                                   │ │
│ │                          │   │   },                                      │ │
│ │                          │   │   'Alabama': {                            │ │
│ │                          │   │   │   'mean': [                           │ │
│ │                          │   │   │   │   83.00301721,                    │ │
│ │                          │   │   │   │   91.24630964,                    │ │
│ │                          │   │   │   │   87.26586959                     │ │
│ │                          │   │   │   ],                                  │ │
│ │                          │   │   │   'std': [                            │ │
│ │                          │   │   │   │   33.38048494,                    │ │
│ │                          │   │   │   │   36.60072106,                    │ │
│ │                          │   │   │   │   41.38057245                     │ │
│ │                          │   │   │   ]                                   │ │
│ │                          │   │   },                                      │ │
│ │                          │   │   'WHU + Alabama': {                      │ │
│ │                          │   │   │   'mean': [                           │ │
│ │                          │   │   │   │   94.21397367,                    │ │
│ │                          │   │   │   │   102.78712076,                   │ │
│ │                          │   │   │   │   99.94002467                     │ │
│ │                          │   │   │   ],                                  │ │
│ │                          │   │   │   'std': [                            │ │
│ │                          │   │   │   │   40.95295341,                    │ │
│ │                          │   │   │   │   41.52023864,                    │ │
│ │                          │   │   │   │   45.4620858                      │ │
│ │                          │   │   │   ]                                   │ │
│ │                          │   │   },                                      │ │
│ │                          │   │   'DataCentric': {                        │ │
│ │                          │   │   │   'mean': [                           │ │
│ │                          │   │   │   │   72.74413315,                    │ │
│ │                          │   │   │   │   99.76137101,                    │ │
│ │                          │   │   │   │   82.70024275                     │ │
│ │                          │   │   │   ],                                  │ │
│ │                          │   │   │   'std': [                            │ │
│ │                          │   │   │   │   36.28290664,                    │ │
│ │                          │   │   │   │   34.82507359,                    │ │
│ │                          │   │   │   │   41.48902725                     │ │
│ │                          │   │   │   ]                                   │ │
│ │                          │   │   }                                       │ │
│ │                          │   },                                          │ │
│ │                          │   'loss': {'alpha': 0.01, 'beta': 1},         │ │
│ │                          │   'trainer': {                                │ │
│ │                          │   │   'wandb_project': 'Unet-NRN-RSSEG',      │ │
│ │                          │   │   'experiment_name': 'Unet-WHU-Kaggle',   │ │
│ │                          │   │   'max_epochs': 50                        │ │
│ │                          │   }                                           │ │
│ │                          }                                               │ │
│ │            config_path = 'config.yaml'                                   │ │
│ │            data_module = <dataloader.DataCentricDataModule object at     │ │
│ │                          0x71c6500bba60>                                 │ │
│ │                 device = 'cuda'                                          │ │
│ │                  epoch = 0                                               │ │
│ │                 epochs = 50                                              │ │
│ │      epochs_no_improve = 0                                               │ │
│ │                 images = tensor([[[[-1.6057e+00, -1.6476e+00,            │ │
│ │                          -1.6574e+00,  ..., -4.0016e-01,                 │ │
│ │                          │   │   │   8.6437e-02, -1.6140e-01],           │ │
│ │                          │   │     [-1.3285e+00, -1.6545e+00,            │ │
│ │                          -1.5750e+00,  ..., -1.2156e-01,                 │ │
│ │                          │   │      -1.7968e-01,  1.3901e-01],           │ │
│ │                          │   │     [-1.5669e+00, -1.4488e+00,            │ │
│ │                          -6.3042e-01,  ..., -3.5192e-01,                 │ │
│ │                          │   │      -2.7311e-01, -1.3648e-01],           │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [ 1.3975e+00,  1.5106e+00,            │ │
│ │                          1.5059e+00,  ..., -3.0128e-01,                  │ │
│ │                          │   │      -4.2110e-01, -2.2981e-01],           │ │
│ │                          │   │     [ 1.9065e+00,  1.6992e+00,            │ │
│ │                          1.5227e+00,  ..., -1.2726e-01,                  │ │
│ │                          │   │      -1.7041e-01, -8.3912e-02],           │ │
│ │                          │   │     [ 1.7547e+00,  1.6726e+00,            │ │
│ │                          1.8519e+00,  ..., -2.6200e-01,                  │ │
│ │                          │   │      -5.4569e-02, -1.7537e-01]],          │ │
│ │                          │   │                                           │ │
│ │                          │   │    [[-1.9443e+00, -2.2536e+00,            │ │
│ │                          -2.3394e+00,  ..., -4.4449e-01,                 │ │
│ │                          │   │   │   2.2302e-02, -1.4976e-01],           │ │
│ │                          │   │     [-1.5320e+00, -2.3026e+00,            │ │
│ │                          -2.1753e+00,  ..., -1.7945e-01,                 │ │
│ │                          │   │      -2.3611e-01,  7.0243e-02],           │ │
│ │                          │   │     [-2.2006e+00, -2.0318e+00,            │ │
│ │                          -6.0187e-01,  ..., -4.5321e-01,                 │ │
│ │                          │   │      -3.4503e-01, -2.1151e-01],           │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [ 1.2662e+00,  1.3896e+00,            │ │
│ │                          1.3815e+00,  ..., -3.4724e-01,                  │ │
│ │                          │   │      -4.6720e-01, -3.1496e-01],           │ │
│ │                          │   │     [ 1.7398e+00,  1.5684e+00,            │ │
│ │                          1.4116e+00,  ..., -1.6473e-01,                  │ │
│ │                          │   │      -2.3538e-01, -2.1151e-01],           │ │
│ │                          │   │     [ 1.6660e+00,  1.5253e+00,            │ │
│ │                          1.6927e+00,  ..., -2.4431e-01,                  │ │
│ │                          │   │      -1.6694e-01, -2.8240e-01]],          │ │
│ │                          │   │                                           │ │
│ │                          │   │    [[-1.6265e+00, -1.6386e+00,            │ │
│ │                          -1.6386e+00,  ..., -3.8765e-01,                 │ │
│ │                          │   │   │   6.9883e-02, -3.8819e-02],           │ │
│ │                          │   │     [-1.4227e+00, -1.6386e+00,            │ │
│ │                          -1.5506e+00,  ..., -1.3410e-01,                 │ │
│ │                          │   │      -1.8596e-01,  1.1751e-01],           │ │
│ │                          │   │     [-1.5772e+00, -1.4302e+00,            │ │
│ │                          -6.2458e-01,  ..., -3.8135e-01,                 │ │
│ │                          │   │      -2.9152e-01, -1.7141e-01],           │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [ 1.1970e+00,  1.2642e+00,            │ │
│ │                          1.2657e+00,  ..., -3.0202e-01,                  │ │
│ │                          │   │      -4.1036e-01, -2.4443e-01],           │ │
│ │                          │   │     [ 1.6630e+00,  1.4685e+00,            │ │
│ │                          1.2876e+00,  ..., -1.2608e-01,                  │ │
│ │                          │   │      -2.0355e-01, -1.3366e-01],           │ │
│ │                          │   │     [ 1.4138e+00,  1.4520e+00,            │ │
│ │                          1.6220e+00,  ..., -2.1374e-01,                  │ │
│ │                          │   │      -1.2555e-01, -2.3274e-01]]],         │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[ 2.9561e+00,  2.9561e+00,            │ │
│ │                          3.0388e+00,  ..., -1.1505e+00,                  │ │
│ │                          │   │      -9.3003e-01, -8.7491e-01],           │ │
│ │                          │   │     [ 2.9561e+00,  3.0112e+00,            │ │
│ │                          3.0388e+00,  ..., -1.5915e+00,                  │ │
│ │                          │   │      -5.7173e-01, -3.5124e-01],           │ │
│ │                          │   │     [ 2.9837e+00,  3.0388e+00,            │ │
│ │                          3.0663e+00,  ..., -1.7293e+00,                  │ │
│ │                          │   │      -6.2686e-01, -2.4100e-01],           │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [-1.3075e-01,  5.3071e-01,            │ │
│ │                          -1.0319e-01,  ..., -4.3393e-01,                 │ │
│ │                          │   │      -3.5124e-01, -4.0637e-01],           │ │
│ │                          │   │     [-6.8198e-01, -9.3003e-01,            │ │
│ │                          6.2174e-02,  ..., -3.2368e-01,                  │ │
│ │                          │   │      -1.8588e-01, -2.4100e-01],           │ │
│ │                          │   │     [-1.0319e-01, -3.7880e-01,            │ │
│ │                          -9.8515e-01,  ..., -1.3075e-01,                 │ │
│ │                          │   │      -1.8588e-01, -1.8588e-01]],          │ │
│ │                          │   │                                           │ │
│ │                          │   │    [[ 2.4763e+00,  2.4763e+00,            │ │
│ │                          2.5625e+00,  ..., -7.1102e-01,                  │ │
│ │                          │   │      -7.9717e-01, -6.8231e-01],           │ │
│ │                          │   │     [ 2.4763e+00,  2.5338e+00,            │ │
│ │                          2.5625e+00,  ..., -1.1992e+00,                  │ │
│ │                          │   │      -3.6644e-01, -1.3672e-01],           │ │
│ │                          │   │     [ 2.5051e+00,  2.5625e+00,            │ │
│ │                          2.5912e+00,  ..., -1.4002e+00,                  │ │
│ │                          │   │      -4.2387e-01, -2.1863e-02],           │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [-9.4074e-01, -1.9415e-01,            │ │
│ │                          -8.5460e-01,  ..., -3.3773e-01,                 │ │
│ │                          │   │      -2.5158e-01, -3.0901e-01],           │ │
│ │                          │   │     [-1.5150e+00, -1.7735e+00,            │ │
│ │                          -6.8231e-01,  ..., -2.5158e-01,                 │ │
│ │                          │   │      -1.0801e-01, -1.6544e-01],           │ │
│ │                          │   │     [-9.1203e-01, -1.1992e+00,            │ │
│ │                          -1.8309e+00,  ..., -7.9293e-02,                 │ │
│ │                          │   │      -1.9415e-01, -1.9415e-01]],          │ │
│ │                          │   │                                           │ │
│ │                          │   │    [[ 2.4657e+00,  2.4657e+00,            │ │
│ │                          2.5380e+00,  ..., -1.0533e+00,                  │ │
│ │                          │   │      -9.0868e-01, -8.1227e-01],           │ │
│ │                          │   │     [ 2.4657e+00,  2.5139e+00,            │ │
│ │                          2.5380e+00,  ..., -1.3907e+00,                  │ │
│ │                          │   │      -5.2304e-01, -3.5432e-01],           │ │
│ │                          │   │     [ 2.4898e+00,  2.5380e+00,            │ │
│ │                          2.5621e+00,  ..., -1.4389e+00,                  │ │
│ │                          │   │      -5.7124e-01, -2.3380e-01],           │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [-4.7483e-01,  1.5184e-01,            │ │
│ │                          -4.0252e-01,  ..., -4.0981e-02,                 │ │
│ │                          │   │      -1.6149e-01, -2.0970e-01],           │ │
│ │                          │   │     [-9.5689e-01, -1.1738e+00,            │ │
│ │                          -2.5791e-01,  ...,  7.9533e-02,                 │ │
│ │                          │   │   │   7.2250e-03, -4.0981e-02],           │ │
│ │                          │   │     [-4.5073e-01, -6.9175e-01,            │ │
│ │                          -1.2220e+00,  ...,  2.7236e-01,                 │ │
│ │                          │   │   │   7.2250e-03,  7.2250e-03]]],         │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[-5.4611e-01, -5.0775e-01,            │ │
│ │                          -7.4412e-01,  ..., -1.6583e-01,                 │ │
│ │                          │   │      -2.1229e-01, -3.4165e-01],           │ │
│ │                          │   │     [-6.3979e-01, -5.2130e-01,            │ │
│ │                          -6.4040e-01,  ..., -2.9558e-01,                 │ │
│ │                          │   │      -1.8147e-01, -1.9354e-01],           │ │
│ │                          │   │     [-3.8752e-01, -3.3765e-01,            │ │
│ │                          -5.0810e-01,  ..., -3.1127e-01,                 │ │
│ │                          │   │      -2.3460e-01, -2.5711e-01],           │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [ 4.2016e-02,  4.5969e-01,            │ │
│ │                          6.6829e-01,  ...,  2.0216e+00,                  │ │
│ │                          │   │   │   1.9338e+00,  1.9428e+00],           │ │
│ │                          │   │     [-2.2533e-01, -7.5557e-02,            │ │
│ │                          2.7569e-01,  ...,  2.0123e+00,                  │ │
│ │                          │   │   │   1.9702e+00,  2.0528e+00],           │ │
│ │                          │   │     [-5.1537e-01, -3.2802e-01,            │ │
│ │                          1.8302e-01,  ...,  2.0634e+00,                  │ │
│ │                          │   │   │   2.1078e+00,  2.1222e+00]],          │ │
│ │                          │   │                                           │ │
│ │                          │   │    [[-3.7468e-01, -3.3599e-01,            │ │
│ │                          -5.3953e-01,  ...,  1.0346e-01,                 │ │
│ │                          │   │   │   5.1739e-02, -8.6796e-02],           │ │
│ │                          │   │     [-4.8906e-01, -3.6196e-01,            │ │
│ │                          -4.4107e-01,  ..., -5.8019e-02,                 │ │
│ │                          │   │   │   7.0032e-02,  7.8653e-02],           │ │
│ │                          │   │     [-1.3918e-01, -1.1689e-01,            │ │
│ │                          -3.0676e-01,  ..., -4.0357e-02,                 │ │
│ │                          │   │   │   4.0595e-02,  3.3236e-02],           │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [ 5.8468e-02,  5.9843e-01,            │ │
│ │                          8.4754e-01,  ...,  1.9312e+00,                  │ │
│ │                          │   │   │   1.8797e+00,  1.8743e+00],           │ │
│ │                          │   │     [-3.1286e-01, -9.5920e-02,            │ │
│ │                          2.5990e-01,  ...,  1.8933e+00,                  │ │
│ │                          │   │   │   1.8650e+00,  1.9155e+00],           │ │
│ │                          │   │     [-5.7846e-01, -4.6383e-01,            │ │
│ │                          -3.4049e-02,  ...,  1.7999e+00,                 │ │
│ │                          │   │   │   1.8647e+00,  1.9245e+00]],          │ │
│ │                          │   │                                           │ │
│ │                          │   │    [[-2.5693e-01, -2.7971e-01,            │ │
│ │                          -5.9790e-01,  ...,  1.1398e-01,                 │ │
│ │                          │   │   │   7.3763e-02, -3.7610e-02],           │ │
│ │                          │   │     [-3.7037e-01, -2.6127e-01,            │ │
│ │                          -3.8629e-01,  ..., -2.2983e-02,                 │ │
│ │                          │   │   │   9.9250e-02,  1.0234e-01],           │ │
│ │                          │   │     [-4.9034e-03,  5.8197e-02,            │ │
│ │                          -1.9707e-01,  ..., -3.2243e-02,                 │ │
│ │                          │   │   │   5.4493e-02,  3.6370e-02],           │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [ 1.3620e-01,  7.4622e-01,            │ │
│ │                          1.0351e+00,  ...,  1.8738e+00,                  │ │
│ │                          │   │   │   1.8695e+00,  1.8302e+00],           │ │
│ │                          │   │     [-2.3808e-01,  2.2700e-02,            │ │
│ │                          3.6440e-01,  ...,  1.8130e+00,                  │ │
│ │                          │   │   │   1.8377e+00,  1.8309e+00],           │ │
│ │                          │   │     [-4.7020e-01, -3.6472e-01,            │ │
│ │                          2.0496e-02,  ...,  1.6104e+00,                  │ │
│ │                          │   │   │   1.7226e+00,  1.8254e+00]]],         │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   ...,                                    │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[-1.5200e+00, -1.4972e+00,            │ │
│ │                          -1.3758e+00,  ...,  1.0254e+00,                 │ │
│ │                          │   │   │   6.8592e-01, -6.3042e-01],           │ │
│ │                          │   │     [-1.5070e+00, -1.5048e+00,            │ │
│ │                          -1.1657e+00,  ...,  1.0502e+00,                 │ │
│ │                          │   │   │   9.1648e-01, -6.4020e-01],           │ │
│ │                          │   │     [-1.5025e+00, -1.4770e+00,            │ │
│ │                          -6.5466e-01,  ...,  1.0285e+00,                 │ │
│ │                          │   │   │   6.8755e-01, -1.0253e+00],           │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [-4.6903e-01, -3.3836e-02,            │ │
│ │                          -3.4657e-01,  ..., -4.0968e-02,                 │ │
│ │                          │   │   │   8.5984e-03, -1.4260e-01],           │ │
│ │                          │   │     [-6.4468e-01, -7.0494e-01,            │ │
│ │                          -5.8370e-01,  ...,  7.4925e-02,                 │ │
│ │                          │   │   │   9.0258e-02, -1.5890e-01],           │ │
│ │                          │   │     [-5.9874e-01, -4.5151e-01,            │ │
│ │                          -4.6577e-01,  ...,  1.8547e-01,                 │ │
│ │                          │   │      -7.4946e-02, -1.6233e-01]],          │ │
│ │                          │   │                                           │ │
│ │                          │   │    [[-1.6430e+00, -1.6190e+00,            │ │
│ │                          -1.4163e+00,  ...,  9.5420e-01,                 │ │
│ │                          │   │   │   6.8212e-01, -7.1399e-01],           │ │
│ │                          │   │     [-1.6556e+00, -1.6399e+00,            │ │
│ │                          -1.0773e+00,  ...,  9.6971e-01,                 │ │
│ │                          │   │   │   8.2620e-01, -7.8974e-01],           │ │
│ │                          │   │     [-1.6766e+00, -1.6388e+00,            │ │
│ │                          -6.6222e-01,  ...,  9.2555e-01,                 │ │
│ │                          │   │   │   5.7672e-01, -1.2212e+00],           │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [-2.3632e-01,  2.0839e-01,            │ │
│ │                          -5.4340e-02,  ...,  1.1897e-01,                 │ │
│ │                          │   │   │   6.8561e-02, -2.0605e-01],           │ │
│ │                          │   │     [-3.3978e-01, -3.4540e-01,            │ │
│ │                          -1.9969e-01,  ...,  2.3304e-01,                 │ │
│ │                          │   │   │   1.3443e-01, -2.3170e-01],           │ │
│ │                          │   │     [-3.6074e-01, -1.2152e-01,            │ │
│ │                          -1.1816e-01,  ...,  3.7681e-01,                 │ │
│ │                          │   │      -2.3536e-02, -1.5937e-01]],          │ │
│ │                          │   │                                           │ │
│ │                          │   │    [[-1.5745e+00, -1.5599e+00,            │ │
│ │                          -1.4410e+00,  ...,  9.4474e-01,                 │ │
│ │                          │   │   │   6.9533e-01, -6.6855e-01],           │ │
│ │                          │   │     [-1.5839e+00, -1.5781e+00,            │ │
│ │                          -1.2107e+00,  ...,  9.6383e-01,                 │ │
│ │                          │   │   │   8.7401e-01, -7.1114e-01],           │ │
│ │                          │   │     [-1.5952e+00, -1.5580e+00,            │ │
│ │                          -7.2397e-01,  ...,  9.2000e-01,                 │ │
│ │                          │   │   │   6.1102e-01, -1.1327e+00],           │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [-4.9595e-01,  6.2210e-02,            │ │
│ │                          -2.1714e-01,  ...,  2.2241e-01,                 │ │
│ │                          │   │   │   2.3352e-01, -1.5839e-02],           │ │
│ │                          │   │     [-5.7956e-01, -5.5605e-01,            │ │
│ │                          -4.1160e-01,  ...,  4.2057e-01,                 │ │
│ │                          │   │   │   3.7088e-01, -4.9352e-02],           │ │
│ │                          │   │     [-5.6091e-01, -3.9153e-01,            │ │
│ │                          -3.6578e-01,  ...,  5.8069e-01,                 │ │
│ │                          │   │   │   2.1452e-01,  3.4556e-02]]],         │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[ 1.2411e-01, -3.0194e-01,            │ │
│ │                          -3.7041e-01,  ..., -5.7458e-01,                 │ │
│ │                          │   │      -4.3276e-01, -6.6954e-01],           │ │
│ │                          │   │     [ 3.0605e-02,  1.1451e-01,            │ │
│ │                          -2.7417e-02,  ..., -5.8584e-01,                 │ │
│ │                          │   │      -5.1666e-01, -3.8345e-01],           │ │
│ │                          │   │     [ 3.7905e-01,  2.2434e-01,            │ │
│ │                          4.2118e-02,  ..., -5.2736e-01,                  │ │
│ │                          │   │      -3.7902e-01, -3.7448e-01],           │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [ 1.0609e+00,  1.6671e+00,            │ │
│ │                          2.3229e+00,  ..., -6.7300e-04,                  │ │
│ │                          │   │      -2.3353e-01, -2.3592e-01],           │ │
│ │                          │   │     [ 5.1965e-01, -6.2364e-01,            │ │
│ │                          2.5002e-02,  ...,  4.4186e-01,                  │ │
│ │                          │   │      -1.5116e-01, -3.5655e-01],           │ │
│ │                          │   │     [-2.6946e-01, -1.2747e+00,            │ │
│ │                          -8.5008e-01,  ...,  3.5419e-01,                 │ │
│ │                          │   │      -7.0463e-02, -6.5231e-01]],          │ │
│ │                          │   │                                           │ │
│ │                          │   │    [[ 3.6594e-01, -6.7692e-02,            │ │
│ │                          -3.3347e-01,  ..., -4.6594e-01,                 │ │
│ │                          │   │      -2.9772e-01, -6.1546e-01],           │ │
│ │                          │   │     [ 2.6369e-01,  3.7802e-01,            │ │
│ │                          1.9440e-01,  ..., -4.7456e-01,                  │ │
│ │                          │   │      -4.1347e-01, -2.3296e-01],           │ │
│ │                          │   │     [ 5.0549e-01,  5.2300e-01,            │ │
│ │                          3.6514e-01,  ..., -3.3179e-01,                  │ │
│ │                          │   │      -1.5811e-01, -1.0091e-01],           │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [ 6.5520e-01,  1.1379e+00,            │ │
│ │                          1.7064e+00,  ...,  1.9253e-02,                  │ │
│ │                          │   │      -2.0373e-01, -1.7871e-01],           │ │
│ │                          │   │     [ 2.3593e-01, -8.7012e-01,            │ │
│ │                          -2.8873e-01,  ...,  3.9973e-01,                 │ │
│ │                          │   │      -1.1689e-01, -2.8973e-01],           │ │
│ │                          │   │     [-2.1368e-01, -1.4016e+00,            │ │
│ │                          -9.4576e-01,  ...,  2.7588e-01,                 │ │
│ │                          │   │      -7.6102e-02, -5.9480e-01]],          │ │
│ │                          │   │                                           │ │
│ │                          │   │    [[ 2.7202e-01, -1.8481e-01,            │ │
│ │                          -3.5767e-01,  ..., -7.7428e-01,                 │ │
│ │                          │   │      -6.7339e-01, -9.3383e-01],           │ │
│ │                          │   │     [ 7.9055e-02,  2.2025e-01,            │ │
│ │                          7.1470e-02,  ..., -7.7860e-01,                  │ │
│ │                          │   │      -7.4496e-01, -6.1977e-01],           │ │
│ │                          │   │     [ 4.7062e-01,  3.6872e-01,            │ │
│ │                          1.9555e-01,  ..., -6.2921e-01,                  │ │
│ │                          │   │      -4.5697e-01, -5.3934e-01],           │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [ 9.8460e-01,  1.4608e+00,            │ │
│ │                          1.9852e+00,  ..., -6.4653e-02,                  │ │
│ │                          │   │      -3.2023e-01, -3.4532e-01],           │ │
│ │                          │   │     [ 4.1559e-01, -6.6316e-01,            │ │
│ │                          -1.4031e-02,  ...,  3.1378e-01,                 │ │
│ │                          │   │      -2.1559e-01, -4.0635e-01],           │ │
│ │                          │   │     [-3.2466e-01, -1.3013e+00,            │ │
│ │                          -8.9704e-01,  ...,  1.8136e-01,                 │ │
│ │                          │   │      -1.7741e-01, -6.9516e-01]]],         │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[-1.1129e+00, -1.1203e+00,            │ │
│ │                          -1.1048e+00,  ...,  1.4798e-01,                 │ │
│ │                          │   │   │   1.3982e-01,  1.4600e-01],           │ │
│ │                          │   │     [-1.1248e+00, -1.0954e+00,            │ │
│ │                          -1.0754e+00,  ...,  7.7064e-01,                 │ │
│ │                          │   │   │   4.5042e-01,  1.7569e-01],           │ │
│ │                          │   │     [-1.1117e+00, -1.0733e+00,            │ │
│ │                          -1.0819e+00,  ...,  1.6354e+00,                 │ │
│ │                          │   │   │   5.7843e-01,  4.2551e-01],           │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [-6.8136e-01, -1.1696e+00,            │ │
│ │                          -1.4188e+00,  ..., -3.1875e-01,                 │ │
│ │                          │   │      -3.1127e-01, -2.0902e-01],           │ │
│ │                          │   │     [-2.2044e-01, -4.7102e-01,            │ │
│ │                          -1.2520e+00,  ..., -2.6598e-01,                 │ │
│ │                          │   │      -2.9664e-01, -2.8849e-01],           │ │
│ │                          │   │     [-8.8744e-02, -1.0999e-01,            │ │
│ │                          -5.5706e-01,  ..., -5.6562e-01,                 │ │
│ │                          │   │      -3.1702e-01, -4.1703e-02]],          │ │
│ │                          │   │                                           │ │
│ │                          │   │    [[-1.1946e+00, -1.1850e+00,            │ │
│ │                          -1.1670e+00,  ...,  1.9893e-01,                 │ │
│ │                          │   │   │   1.9766e-01,  1.7033e-01],           │ │
│ │                          │   │     [-1.2048e+00, -1.1641e+00,            │ │
│ │                          -1.1343e+00,  ...,  7.0220e-01,                 │ │
│ │                          │   │   │   4.4057e-01,  1.9051e-01],           │ │
│ │                          │   │     [-1.1737e+00, -1.1384e+00,            │ │
│ │                          -1.1431e+00,  ...,  1.6181e+00,                 │ │
│ │                          │   │   │   5.7819e-01,  4.3821e-01],           │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [-6.3667e-01, -1.1339e+00,            │ │
│ │                          -1.4394e+00,  ..., -3.1743e-01,                 │ │
│ │                          │   │      -3.0566e-01, -1.9553e-01],           │ │
│ │                          │   │     [-1.0974e-01, -3.4650e-01,            │ │
│ │                          -1.2083e+00,  ..., -2.3575e-01,                 │ │
│ │                          │   │      -2.8395e-01, -2.8469e-01],           │ │
│ │                          │   │     [ 5.1619e-02,  6.6037e-02,            │ │
│ │                          -4.1253e-01,  ..., -4.9201e-01,                 │ │
│ │                          │   │      -2.7585e-01, -2.4797e-02]],          │ │
│ │                          │   │                                           │ │
│ │                          │   │    [[-1.2644e+00, -1.2547e+00,            │ │
│ │                          -1.2417e+00,  ...,  1.8594e-01,                 │ │
│ │                          │   │   │   2.0993e-01,  2.1114e-01],           │ │
│ │                          │   │     [-1.2650e+00, -1.2274e+00,            │ │
│ │                          -1.2070e+00,  ...,  7.1659e-01,                 │ │
│ │                          │   │   │   4.6163e-01,  2.1240e-01],           │ │
│ │                          │   │     [-1.2420e+00, -1.2135e+00,            │ │
│ │                          -1.2219e+00,  ...,  1.6302e+00,                 │ │
│ │                          │   │   │   5.8077e-01,  4.3076e-01],           │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [-5.2276e-01, -1.0734e+00,            │ │
│ │                          -1.4410e+00,  ..., -3.5665e-01,                 │ │
│ │                          │   │      -3.0819e-01, -1.7070e-01],           │ │
│ │                          │   │     [ 1.4361e-01, -1.1527e-01,            │ │
│ │                          -1.1549e+00,  ..., -2.4029e-01,                 │ │
│ │                          │   │      -2.7455e-01, -2.6630e-01],           │ │
│ │                          │   │     [ 3.8853e-01,  4.3464e-01,            │ │
│ │                          -2.3984e-01,  ..., -4.9842e-01,                 │ │
│ │                          │   │      -2.6489e-01, -3.3411e-03]]]],        │ │
│ │                          device='cuda:0')                                │ │
│ │            input_files = [                                               │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │   ... +4990                                   │ │
│ │                          ]                                               │ │
│ │            input_paths = '/media/tidop/Datos_4TB1/databases/kaggle/data… │ │
│ │   kaggle_train_dataset = <dataloader.StudentDataset object at            │ │
│ │                          0x71c6500bbbb0>                                 │ │
│ │     kaggle_val_dataset = <dataloader.StudentDataset object at            │ │
│ │                          0x71c6500bbb20>                                 │ │
│ │            label_files = [                                               │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │                                               │ │
│ │                          PosixPath('/media/tidop/Datos_4TB1/databases/k… │ │
│ │                          │   ... +4990                                   │ │
│ │                          ]                                               │ │
│ │            label_paths = '/media/tidop/Datos_4TB1/databases/kaggle/data… │ │
│ │                 logits = tensor([[[[-0.0442,  0.0066,  0.0912,  ...,     │ │
│ │                          0.0486,  0.0975,  0.1186],                      │ │
│ │                          │   │     [-0.0812,  0.0555,  0.1577,  ...,     │ │
│ │                          0.0644,  0.0153,  0.1093],                      │ │
│ │                          │   │     [ 0.0913,  0.0376,  0.1855,  ...,     │ │
│ │                          0.0816,  0.1105,  0.0518],                      │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [ 0.1902,  0.1091,  0.0753,  ...,     │ │
│ │                          0.1453,  0.0811,  0.1514],                      │ │
│ │                          │   │     [ 0.0847,  0.0518,  0.1117,  ...,     │ │
│ │                          0.0867,  0.0663,  0.1072],                      │ │
│ │                          │   │     [-0.0038,  0.0177,  0.1465,  ...,     │ │
│ │                          0.0827,  0.0644,  0.1121]]],                    │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[ 0.2075, -0.0320, -0.1608,  ...,     │ │
│ │                          0.0207,  0.0463,  0.0976],                      │ │
│ │                          │   │     [ 0.1033,  0.0301, -0.1747,  ...,     │ │
│ │                          -0.0036,  0.1403,  0.1135],                     │ │
│ │                          │   │     [ 0.2013,  0.0212, -0.0192,  ...,     │ │
│ │                          0.0621,  0.1240,  0.0938],                      │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [ 0.1036,  0.0051,  0.0642,  ...,     │ │
│ │                          0.0861,  0.0081,  0.1137],                      │ │
│ │                          │   │     [ 0.1413, -0.1108,  0.0325,  ...,     │ │
│ │                          0.0670,  0.0214,  0.0974],                      │ │
│ │                          │   │     [ 0.0982,  0.0814,  0.1924,  ...,     │ │
│ │                          0.0505,  0.0060,  0.1139]]],                    │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[ 0.1175,  0.0490,  0.1248,  ...,     │ │
│ │                          0.0861,  0.0997,  0.1081],                      │ │
│ │                          │   │     [ 0.1541,  0.0945,  0.0931,  ...,     │ │
│ │                          0.0706,  0.0193,  0.0843],                      │ │
│ │                          │   │     [ 0.1663,  0.1514,  0.1403,  ...,     │ │
│ │                          0.1166,  0.0312,  0.0920],                      │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [ 0.0887,  0.0518,  0.0644,  ...,     │ │
│ │                          -0.1372,  0.0608,  0.1887],                     │ │
│ │                          │   │     [ 0.0356, -0.0421,  0.0254,  ...,     │ │
│ │                          -0.1039,  0.1035,  0.2860],                     │ │
│ │                          │   │     [ 0.0532,  0.0642,  0.0912,  ...,     │ │
│ │                          -0.0585,  0.0791,  0.1919]]],                   │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   ...,                                    │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[ 0.0051,  0.0209,  0.0599,  ...,     │ │
│ │                          -0.0507,  0.0539,  0.1300],                     │ │
│ │                          │   │     [ 0.1371,  0.0483,  0.0676,  ...,     │ │
│ │                          0.0353,  0.0693,  0.0735],                      │ │
│ │                          │   │     [ 0.1830,  0.0339,  0.2078,  ...,     │ │
│ │                          0.0141,  0.0863,  0.0662],                      │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [ 0.1149,  0.1617,  0.1721,  ...,     │ │
│ │                          0.0845,  0.0620,  0.1349],                      │ │
│ │                          │   │     [ 0.1313, -0.0097,  0.1248,  ...,     │ │
│ │                          0.0591,  0.0316,  0.1395],                      │ │
│ │                          │   │     [ 0.0927,  0.0533,  0.0698,  ...,     │ │
│ │                          0.0849,  0.0693,  0.1056]]],                    │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[ 0.1225,  0.0321,  0.0414,  ...,     │ │
│ │                          0.1126,  0.1458,  0.0915],                      │ │
│ │                          │   │     [ 0.1392,  0.0911,  0.1089,  ...,     │ │
│ │                          0.1374,  0.1734,  0.1189],                      │ │
│ │                          │   │     [ 0.1377,  0.0504,  0.0577,  ...,     │ │
│ │                          0.0655,  0.0747,  0.0616],                      │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [ 0.1978, -0.0637, -0.0202,  ...,     │ │
│ │                          0.2614,  0.1630,  0.1856],                      │ │
│ │                          │   │     [ 0.2528,  0.1122, -0.0746,  ...,     │ │
│ │                          0.4092,  0.1201,  0.0745],                      │ │
│ │                          │   │     [ 0.1223,  0.1449,  0.1132,  ...,     │ │
│ │                          0.1667,  0.0301,  0.0841]]],                    │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[ 0.0338,  0.0672,  0.0661,  ...,     │ │
│ │                          0.0961, -0.0198,  0.0830],                      │ │
│ │                          │   │     [ 0.0923,  0.0824,  0.0428,  ...,     │ │
│ │                          0.0239,  0.0318,  0.0894],                      │ │
│ │                          │   │     [ 0.1155,  0.1204,  0.0714,  ...,     │ │
│ │                          0.1986,  0.0297,  0.1507],                      │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [ 0.1700,  0.0092,  0.0247,  ...,     │ │
│ │                          0.1463,  0.1383,  0.1285],                      │ │
│ │                          │   │     [ 0.2804,  0.1514,  0.2589,  ...,     │ │
│ │                          0.0341,  0.0171,  0.0668],                      │ │
│ │                          │   │     [ 0.1696,  0.2213,  0.1891,  ...,     │ │
│ │                          0.1149,  0.1036,  0.1322]]]],                   │ │
│ │                          │      device='cuda:0',                         │ │
│ │                          grad_fn=<ConvolutionBackward0>)                 │ │
│ │                     lr = 0.0001                                          │ │
│ │                  masks = tensor([[[[0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.]]],     │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[1., 1., 1.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [1., 1., 1.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [1., 1., 1.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.]]],     │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [0., 0., 0.,  ..., 1., 1., 1.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 1., 1., 1.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 1., 1., 1.]]],     │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   ...,                                    │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.]]],     │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.]]],     │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[1., 1., 1.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [1., 1., 1.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [1., 1., 1.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.],       │ │
│ │                          │   │     [0., 0., 0.,  ..., 0., 0., 0.]]]],    │ │
│ │                          device='cuda:0')                                │ │
│ │            max_val_iou = 0                                               │ │
│ │                   mean = [72.74413315, 99.76137101, 82.70024275]         │ │
│ │              normalize = True                                            │ │
│ │            num_workers = 16                                              │ │
│ │              optimizer = Adam (                                          │ │
│ │                          Parameter Group 0                               │ │
│ │                          │   amsgrad: False                              │ │
│ │                          │   betas: (0.9, 0.999)                         │ │
│ │                          │   capturable: False                           │ │
│ │                          │   differentiable: False                       │ │
│ │                          │   eps: 1e-08                                  │ │
│ │                          │   foreach: None                               │ │
│ │                          │   fused: None                                 │ │
│ │                          │   lr: 0.0001                                  │ │
│ │                          │   maximize: False                             │ │
│ │                          │   weight_decay: 0                             │ │
│ │                          )                                               │ │
│ │                outputs = tensor([[[[0.4890, 0.5016, 0.5228,  ...,        │ │
│ │                          0.5122, 0.5244, 0.5296],                        │ │
│ │                          │   │     [0.4797, 0.5139, 0.5393,  ...,        │ │
│ │                          0.5161, 0.5038, 0.5273],                        │ │
│ │                          │   │     [0.5228, 0.5094, 0.5462,  ...,        │ │
│ │                          0.5204, 0.5276, 0.5129],                        │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [0.5474, 0.5272, 0.5188,  ...,        │ │
│ │                          0.5363, 0.5203, 0.5378],                        │ │
│ │                          │   │     [0.5212, 0.5129, 0.5279,  ...,        │ │
│ │                          0.5217, 0.5166, 0.5268],                        │ │
│ │                          │   │     [0.4991, 0.5044, 0.5366,  ...,        │ │
│ │                          0.5207, 0.5161, 0.5280]]],                      │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[0.5517, 0.4920, 0.4599,  ...,        │ │
│ │                          0.5052, 0.5116, 0.5244],                        │ │
│ │                          │   │     [0.5258, 0.5075, 0.4564,  ...,        │ │
│ │                          0.4991, 0.5350, 0.5283],                        │ │
│ │                          │   │     [0.5501, 0.5053, 0.4952,  ...,        │ │
│ │                          0.5155, 0.5310, 0.5234],                        │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [0.5259, 0.5013, 0.5160,  ...,        │ │
│ │                          0.5215, 0.5020, 0.5284],                        │ │
│ │                          │   │     [0.5353, 0.4723, 0.5081,  ...,        │ │
│ │                          0.5167, 0.5054, 0.5243],                        │ │
│ │                          │   │     [0.5245, 0.5203, 0.5479,  ...,        │ │
│ │                          0.5126, 0.5015, 0.5284]]],                      │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[0.5293, 0.5122, 0.5312,  ...,        │ │
│ │                          0.5215, 0.5249, 0.5270],                        │ │
│ │                          │   │     [0.5385, 0.5236, 0.5232,  ...,        │ │
│ │                          0.5176, 0.5048, 0.5211],                        │ │
│ │                          │   │     [0.5415, 0.5378, 0.5350,  ...,        │ │
│ │                          0.5291, 0.5078, 0.5230],                        │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [0.5222, 0.5129, 0.5161,  ...,        │ │
│ │                          0.4657, 0.5152, 0.5470],                        │ │
│ │                          │   │     [0.5089, 0.4895, 0.5064,  ...,        │ │
│ │                          0.4740, 0.5259, 0.5710],                        │ │
│ │                          │   │     [0.5133, 0.5161, 0.5228,  ...,        │ │
│ │                          0.4854, 0.5198, 0.5478]]],                      │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   ...,                                    │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[0.5013, 0.5052, 0.5150,  ...,        │ │
│ │                          0.4873, 0.5135, 0.5325],                        │ │
│ │                          │   │     [0.5342, 0.5121, 0.5169,  ...,        │ │
│ │                          0.5088, 0.5173, 0.5184],                        │ │
│ │                          │   │     [0.5456, 0.5085, 0.5518,  ...,        │ │
│ │                          0.5035, 0.5216, 0.5165],                        │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [0.5287, 0.5403, 0.5429,  ...,        │ │
│ │                          0.5211, 0.5155, 0.5337],                        │ │
│ │                          │   │     [0.5328, 0.4976, 0.5312,  ...,        │ │
│ │                          0.5148, 0.5079, 0.5348],                        │ │
│ │                          │   │     [0.5232, 0.5133, 0.5174,  ...,        │ │
│ │                          0.5212, 0.5173, 0.5264]]],                      │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[0.5306, 0.5080, 0.5104,  ...,        │ │
│ │                          0.5281, 0.5364, 0.5229],                        │ │
│ │                          │   │     [0.5347, 0.5228, 0.5272,  ...,        │ │
│ │                          0.5343, 0.5432, 0.5297],                        │ │
│ │                          │   │     [0.5344, 0.5126, 0.5144,  ...,        │ │
│ │                          0.5164, 0.5187, 0.5154],                        │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [0.5493, 0.4841, 0.4949,  ...,        │ │
│ │                          0.5650, 0.5407, 0.5463],                        │ │
│ │                          │   │     [0.5629, 0.5280, 0.4813,  ...,        │ │
│ │                          0.6009, 0.5300, 0.5186],                        │ │
│ │                          │   │     [0.5305, 0.5362, 0.5283,  ...,        │ │
│ │                          0.5416, 0.5075, 0.5210]]],                      │ │
│ │                          │   │                                           │ │
│ │                          │   │                                           │ │
│ │                          │   │   [[[0.5084, 0.5168, 0.5165,  ...,        │ │
│ │                          0.5240, 0.4950, 0.5207],                        │ │
│ │                          │   │     [0.5231, 0.5206, 0.5107,  ...,        │ │
│ │                          0.5060, 0.5079, 0.5223],                        │ │
│ │                          │   │     [0.5289, 0.5301, 0.5179,  ...,        │ │
│ │                          0.5495, 0.5074, 0.5376],                        │ │
│ │                          │   │     ...,                                  │ │
│ │                          │   │     [0.5424, 0.5023, 0.5062,  ...,        │ │
│ │                          0.5365, 0.5345, 0.5321],                        │ │
│ │                          │   │     [0.5696, 0.5378, 0.5644,  ...,        │ │
│ │                          0.5085, 0.5043, 0.5167],                        │ │
│ │                          │   │     [0.5423, 0.5551, 0.5471,  ...,        │ │
│ │                          0.5287, 0.5259, 0.5330]]]],                     │ │
│ │                          │      device='cuda:0',                         │ │
│ │                          grad_fn=<SigmoidBackward0>)                     │ │
│ │               patience = 5                                               │ │
│ │           running_dice = 0.0                                             │ │
│ │             running_f1 = 0.0                                             │ │
│ │            running_iou = 0.0                                             │ │
│ │           running_loss = 0.0                                             │ │
│ │      running_precision = 0.0                                             │ │
│ │         running_recall = 0.0                                             │ │
│ │              scheduler = <torch.optim.lr_scheduler.ReduceLROnPlateau     │ │
│ │                          object at 0x71c65001b730>                       │ │
│ │                    std = [36.28290664, 34.82507359, 41.48902725]         │ │
│ │                teacher = ResUnetTeacher(                                 │ │
│ │                            (inc): DoubleConv(                            │ │
│ │                          │   (conv): Sequential(                         │ │
│ │                          │     (0): Conv2d(3, 64, kernel_size=(3, 3),    │ │
│ │                          stride=(1, 1), padding=(1, 1), bias=False)      │ │
│ │                          │     (1): BatchNorm2d(64, eps=1e-05,           │ │
│ │                          momentum=0.1, affine=True,                      │ │
│ │                          track_running_stats=True)                       │ │
│ │                          │     (2): ReLU(inplace=True)                   │ │
│ │                          │     (3): Conv2d(64, 64, kernel_size=(3, 3),   │ │
│ │                          stride=(1, 1), padding=(1, 1), bias=False)      │ │
│ │                          │     (4): BatchNorm2d(64, eps=1e-05,           │ │
│ │                          momentum=0.1, affine=True,                      │ │
│ │                          track_running_stats=True)                       │ │
│ │                          │     (5): ReLU(inplace=True)                   │ │
│ │                          │   )                                           │ │
│ │                            )                                             │ │
│ │                            (down1): Down(                                │ │
│ │                          │   (pool): MaxPool2d(kernel_size=2, stride=2,  │ │
│ │                          padding=0, dilation=1, ceil_mode=False)         │ │
│ │                          │   (conv): DoubleConv(                         │ │
│ │                          │     (conv): Sequential(                       │ │
│ │                          │   │   (0): Conv2d(64, 128, kernel_size=(3,    │ │
│ │                          3), stride=(1, 1), padding=(1, 1), bias=False)  │ │
│ │                          │   │   (1): BatchNorm2d(128, eps=1e-05,        │ │
│ │                          momentum=0.1, affine=True,                      │ │
│ │                          track_running_stats=True)                       │ │
│ │                          │   │   (2): ReLU(inplace=True)                 │ │
│ │                          │   │   (3): Conv2d(128, 128, kernel_size=(3,   │ │
│ │                          3), stride=(1, 1), padding=(1, 1), bias=False)  │ │
│ │                          │   │   (4): BatchNorm2d(128, eps=1e-05,        │ │
│ │                          momentum=0.1, affine=True,                      │ │
│ │                          track_running_stats=True)                       │ │
│ │                          │   │   (5): ReLU(inplace=True)                 │ │
│ │                          │     )                                         │ │
│ │                          │   )                                           │ │
│ │                            )                                             │ │
│ │                            (down2): Down(                                │ │
│ │                          │   (pool): MaxPool2d(kernel_size=2, stride=2,  │ │
│ │                          padding=0, dilation=1, ceil_mode=False)         │ │
│ │                          │   (conv): DoubleConv(                         │ │
│ │                          │     (conv): Sequential(                       │ │
│ │                          │   │   (0): Conv2d(128, 256, kernel_size=(3,   │ │
│ │                          3), stride=(1, 1), padding=(1, 1), bias=False)  │ │
│ │                          │   │   (1): BatchNorm2d(256, eps=1e-05,        │ │
│ │                          momentum=0.1, affine=True,                      │ │
│ │                          track_running_stats=True)                       │ │
│ │                          │   │   (2): ReLU(inplace=True)                 │ │
│ │                          │   │   (3): Conv2d(256, 256, kernel_size=(3,   │ │
│ │                          3), stride=(1, 1), padding=(1, 1), bias=False)  │ │
│ │                          │   │   (4): BatchNorm2d(256, eps=1e-05,        │ │
│ │                          momentum=0.1, affine=True,                      │ │
│ │                          track_running_stats=True)                       │ │
│ │                          │   │   (5): ReLU(inplace=True)                 │ │
│ │                          │     )                                         │ │
│ │                          │   )                                           │ │
│ │                            )                                             │ │
│ │                            (up1): Up(                                    │ │
│ │                          │   (up): ConvTranspose2d(256, 128,             │ │
│ │                          kernel_size=(2, 2), stride=(2, 2))              │ │
│ │                          │   (conv): DoubleConv(                         │ │
│ │                          │     (conv): Sequential(                       │ │
│ │                          │   │   (0): Conv2d(256, 128, kernel_size=(3,   │ │
│ │                          3), stride=(1, 1), padding=(1, 1), bias=False)  │ │
│ │                          │   │   (1): BatchNorm2d(128, eps=1e-05,        │ │
│ │                          momentum=0.1, affine=True,                      │ │
│ │                          track_running_stats=True)                       │ │
│ │                          │   │   (2): ReLU(inplace=True)                 │ │
│ │                          │   │   (3): Conv2d(128, 128, kernel_size=(3,   │ │
│ │                          3), stride=(1, 1), padding=(1, 1), bias=False)  │ │
│ │                          │   │   (4): BatchNorm2d(128, eps=1e-05,        │ │
│ │                          momentum=0.1, affine=True,                      │ │
│ │                          track_running_stats=True)                       │ │
│ │                          │   │   (5): ReLU(inplace=True)                 │ │
│ │                          │     )                                         │ │
│ │                          │   )                                           │ │
│ │                            )                                             │ │
│ │                            (att1): AttentionBlock(                       │ │
│ │                          │   (channel_attention): ChannelAttention(      │ │
│ │                          │     (avg_pool):                               │ │
│ │                          AdaptiveAvgPool2d(output_size=1)                │ │
│ │                          │     (max_pool):                               │ │
│ │                          AdaptiveMaxPool2d(output_size=1)                │ │
│ │                          │     (fc): Sequential(                         │ │
│ │                          │   │   (0): Conv2d(128, 8, kernel_size=(1, 1), │ │
│ │                          stride=(1, 1), bias=False)                      │ │
│ │                          │   │   (1): ReLU(inplace=True)                 │ │
│ │                          │   │   (2): Conv2d(8, 128, kernel_size=(1, 1), │ │
│ │                          stride=(1, 1), bias=False)                      │ │
│ │                          │     )                                         │ │
│ │                          │     (sigmoid): Sigmoid()                      │ │
│ │                          │   )                                           │ │
│ │                          │   (spatial_attention): SpatialAttention(      │ │
│ │                          │     (avg_pool): AvgPool2d(kernel_size=7,      │ │
│ │                          stride=1, padding=3)                            │ │
│ │                          │     (max_pool): MaxPool2d(kernel_size=7,      │ │
│ │                          stride=1, padding=3, dilation=1,                │ │
│ │                          ceil_mode=False)                                │ │
│ │                          │     (conv): Conv2d(256, 1, kernel_size=(7,    │ │
│ │                          7), stride=(1, 1), padding=(3, 3), bias=False)  │ │
│ │                          │     (sigmoid): Sigmoid()                      │ │
│ │                          │   )                                           │ │
│ │                            )                                             │ │
│ │                            (up2): Up(                                    │ │
│ │                          │   (up): ConvTranspose2d(128, 64,              │ │
│ │                          kernel_size=(2, 2), stride=(2, 2))              │ │
│ │                          │   (conv): DoubleConv(                         │ │
│ │                          │     (conv): Sequential(                       │ │
│ │                          │   │   (0): Conv2d(128, 64, kernel_size=(3,    │ │
│ │                          3), stride=(1, 1), padding=(1, 1), bias=False)  │ │
│ │                          │   │   (1): BatchNorm2d(64, eps=1e-05,         │ │
│ │                          momentum=0.1, affine=True,                      │ │
│ │                          track_running_stats=True)                       │ │
│ │                          │   │   (2): ReLU(inplace=True)                 │ │
│ │                          │   │   (3): Conv2d(64, 64, kernel_size=(3, 3), │ │
│ │                          stride=(1, 1), padding=(1, 1), bias=False)      │ │
│ │                          │   │   (4): BatchNorm2d(64, eps=1e-05,         │ │
│ │                          momentum=0.1, affine=True,                      │ │
│ │                          track_running_stats=True)                       │ │
│ │                          │   │   (5): ReLU(inplace=True)                 │ │
│ │                          │     )                                         │ │
│ │                          │   )                                           │ │
│ │                            )                                             │ │
│ │                            (att2): AttentionBlock(                       │ │
│ │                          │   (channel_attention): ChannelAttention(      │ │
│ │                          │     (avg_pool):                               │ │
│ │                          AdaptiveAvgPool2d(output_size=1)                │ │
│ │                          │     (max_pool):                               │ │
│ │                          AdaptiveMaxPool2d(output_size=1)                │ │
│ │                          │     (fc): Sequential(                         │ │
│ │                          │   │   (0): Conv2d(64, 4, kernel_size=(1, 1),  │ │
│ │                          stride=(1, 1), bias=False)                      │ │
│ │                          │   │   (1): ReLU(inplace=True)                 │ │
│ │                          │   │   (2): Conv2d(4, 64, kernel_size=(1, 1),  │ │
│ │                          stride=(1, 1), bias=False)                      │ │
│ │                          │     )                                         │ │
│ │                          │     (sigmoid): Sigmoid()                      │ │
│ │                          │   )                                           │ │
│ │                          │   (spatial_attention): SpatialAttention(      │ │
│ │                          │     (avg_pool): AvgPool2d(kernel_size=7,      │ │
│ │                          stride=1, padding=3)                            │ │
│ │                          │     (max_pool): MaxPool2d(kernel_size=7,      │ │
│ │                          stride=1, padding=3, dilation=1,                │ │
│ │                          ceil_mode=False)                                │ │
│ │                          │     (conv): Conv2d(128, 1, kernel_size=(7,    │ │
│ │                          7), stride=(1, 1), padding=(3, 3), bias=False)  │ │
│ │                          │     (sigmoid): Sigmoid()                      │ │
│ │                          │   )                                           │ │
│ │                            )                                             │ │
│ │                            (outc): Conv2d(64, 1, kernel_size=(1, 1),     │ │
│ │                          stride=(1, 1))                                  │ │
│ │                          )                                               │ │
│ │           train_loader = <torch.utils.data.dataloader.DataLoader object  │ │
│ │                          at 0x71c6500bbc10>                              │ │
│ │             val_loader = <torch.utils.data.dataloader.DataLoader object  │ │
│ │                          at 0x71c6500bbf10>                              │ │
│ │               whu_mean = [72.62323902, 99.33869521, 82.94464024]         │ │
│ │             whu_module = <dataloader.BuildingDataModule object at        │ │
│ │                          0x71c6500bb2b0>                                 │ │
│ │               whu_path = '/media/tidop/Datos_4TB1/databases/whu_adjuste… │ │
│ │                whu_std = [43.81751311, 42.46326449, 50.62061044]         │ │
│ │      whu_train_dataset = <dataloader.TeacherDataset object at            │ │
│ │                          0x71c6e2790100>                                 │ │
│ │        whu_val_dataset = <dataloader.TeacherDataset object at            │ │
│ │                          0x71c6500bb8b0>                                 │ │
│ ╰──────────────────────────────────────────────────────────────────────────╯ │
│                                                                              │
│ /home/tidop/projects/Noisy-Student/loss_function.py:201 in                   │
│ symmetric_cross_entropy                                                      │
│                                                                              │
│   198 │                                                                      │
│   199 │   # Forward Cross Entropy: CE(y_true || y_pred)                      │
│   200 │   #   CE = -sum(y_true * log(y_pred)), luego hacemos mean a lo largo │
│ ❱ 201 │   ce_forward = (- y_true * torch.log(y_pred_clamped)).sum() / y_true │
│   202 │   # ce_forward = torch.mean(-torch.sum(y_true * torch.log(y_pred_cla │
│   203 │   # Reverse Cross Entropy: CE(y_pred || y_true)                      │
│   204 │   #   RCE = -sum(y_pred * log(y_true)), luego mean a lo largo del ba │
│                                                                              │
│ ╭───────────────────────────────── locals ─────────────────────────────────╮ │
│ │          alpha = 0.01                                                    │ │
│ │           beta = 1                                                       │ │
│ │         y_pred = tensor([0.4890, 0.5016, 0.5228,  ..., 0.5287, 0.5259,   │ │
│ │                  0.5330], device='cuda:0',                               │ │
│ │                  │      grad_fn=<ViewBackward0>)                         │ │
│ │ y_pred_clamped = tensor([0.4890, 0.5016, 0.5228,  ..., 0.5287, 0.5259,   │ │
│ │                  0.5330], device='cuda:0',                               │ │
│ │                  │      grad_fn=<ClampBackward1>)                        │ │
│ │         y_true = tensor([0., 0., 0.,  ..., 0., 0., 0.], device='cuda:0') │ │
│ │ y_true_clamped = tensor([1.0000e-04, 1.0000e-04, 1.0000e-04,  ...,       │ │
│ │                  1.0000e-04, 1.0000e-04,                                 │ │
│ │                  │   │   1.0000e-04], device='cuda:0')                   │ │
│ ╰──────────────────────────────────────────────────────────────────────────╯ │
╰──────────────────────────────────────────────────────────────────────────────╯
IndexError: Dimension out of range (expected to be in range of [-1, 0], but got
1)
